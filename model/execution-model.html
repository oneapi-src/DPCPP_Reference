
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Execution Model &#8212; DPC++ Reference  documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/custom.js"></script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <link rel="shortcut icon" href="../_static/favicons.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Memory Model" href="memory-model.html" />
    <link rel="prev" title="Platform Model" href="platform-model.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/oneAPI-rgb-rev-100.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">DPC++ Reference  documentation</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="reference internal" href="index.html">
   Programming Model
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="sample-program.html">
     Anatomy of a DPC++ Program
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="platform-model.html">
     Platform Model
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Execution Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="memory-model.html">
     Memory Model
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="memory-objects.html">
       Memory Objects
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="accessors.html">
       Accessors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="synchronization.html">
       Synchronization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="unified-shared-memory.html">
       Unified Shared Memory
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="memory-types.html">
       Memory Types
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kernel-programming-model.html">
     Kernel Programming Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="error-handling.html">
     Error Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fall-back.html">
     Fall Back
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dpcpp-index.html">
   Interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notices.html">
   Notices and Disclaimers
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/model/execution-model.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/oneapi-src/DPCPP_Reference/issues/new?title=Issue%20on%20page%20%2Fmodel/execution-model.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/oneapi-src/DPCPP_Reference/edit/dpcpp/source/model/execution-model.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application-execution-model">
   Application Execution Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kernel-execution-model">
   Kernel Execution Model
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="execution-model">
<span id="id1"></span><h1>Execution Model<a class="headerlink" href="#execution-model" title="Permalink to this headline">¶</a></h1>
<p>The execution model is based upon the SYCL* execution model. It
defines and specifies how code, termed kernels, execute on the host
and the devices. We explain the execution model in 2 parts,
<em>application execution model</em> and <em>kernel execution model</em>.</p>
<div class="section" id="application-execution-model">
<h2>Application Execution Model<a class="headerlink" href="#application-execution-model" title="Permalink to this headline">¶</a></h2>
<p>The application execution model coordinates execution and data
management between the host and devices via command groups. The
command groups, which are groupings of commands like kernel invocation
and accessors, are submitted to queues for execution. Accessors, which
are formally part of the memory model, also communicate ordering
requirements of execution. A program employing the execution model
declares and instantiates <a class="reference internal" href="../iface/queue.html#queue"><span class="std std-ref">sycl::queue</span></a>s. Queues can execute with an in-order
or out-of-order policy controllable by the program.</p>
</div>
<div class="section" id="kernel-execution-model">
<h2>Kernel Execution Model<a class="headerlink" href="#kernel-execution-model" title="Permalink to this headline">¶</a></h2>
<p>The device execution model specifies how computation is accomplished
on the accelerator. Compute ranging from small one-dimensional data to
large multidimensional data sets are allocated across a hierarchy of
<a class="reference internal" href="../glossary.html#term-nd-range"><span class="xref std std-term">nd-range</span></a>, <a class="reference internal" href="../glossary.html#term-work-group"><span class="xref std std-term">work-group</span></a>, <a class="reference internal" href="../glossary.html#term-sub-group"><span class="xref std std-term">sub-group</span></a>, and
<a class="reference internal" href="../glossary.html#term-work-item"><span class="xref std std-term">work-item</span></a>, which are all specified when the work is submitted
to the command queue.  It is important to note that the actual kernel
code represents the work that is executed for one work-item. The code
outside of the kernel controls just how much parallelism is executed;
the amount and distribution of the work is controlled by specification
of the sizes of the ND-range and work-group.</p>
<p>The following figure depicts the relationship between an ND-range,
work-group, sub-group, and work-item. The total amount of work is
specified by the ND-range size. The grouping of the work is specified by
the work-group size. The example shows the ND-range size of X * Y * Z,
work-group size of X’ * Y’ * Z’, and subgroup size of X’. Therefore,
there are X * Y * Z work-items. There are (X * Y * Z) / (X’ * Y’ *
Z’) work-groups and (X * Y * Z) / X’ subgroups.</p>
<p><a class="reference internal" href="../_images/nd-range.png"><img alt="nd-range" src="../_images/nd-range.png" style="width: 468px; height: 453px;" /></a></p>
<p>When kernels are executed, the location of a particular work-item in the
larger ND-range, work-group, or sub-group is important. For example, if
the work-item is assigned to compute on specific pieces of data, a
method of specification is necessary. Unique identification of the
work-item is provided via intrinsic functions such as those in the
<code class="docutils literal notranslate"><span class="pre">nd_item</span></code> class (<code class="docutils literal notranslate"><span class="pre">global_id</span></code>, <code class="docutils literal notranslate"><span class="pre">work_group_id</span></code>, and <code class="docutils literal notranslate"><span class="pre">local_id</span></code>).</p>
<p>The following code sample launches a kernel and displays the
relationships of the previously discussed <code class="docutils literal notranslate"><span class="pre">ND-range</span></code>, <code class="docutils literal notranslate"><span class="pre">work-group</span></code>,
and <code class="docutils literal notranslate"><span class="pre">work-item</span></code>.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#include &lt;CL/sycl.hpp&gt;</span>
<span class="c1">#include &lt;iostream&gt;</span>
<span class="c1">#include &lt;iomanip&gt;</span>

<span class="n">const</span> <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
<span class="n">const</span> <span class="nb">int</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">sycl</span><span class="p">;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">queue</span> <span class="n">q</span><span class="p">;</span>
  <span class="n">buffer</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">buf</span><span class="p">(</span><span class="nb">range</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">));</span>

  <span class="n">q</span><span class="o">.</span><span class="n">submit</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">handler</span> <span class="o">&amp;</span><span class="n">h</span><span class="p">){</span>
      <span class="n">auto</span> <span class="n">bufacc</span> <span class="o">=</span> <span class="n">buf</span><span class="o">.</span><span class="n">get_access</span><span class="o">&lt;</span><span class="n">access</span><span class="p">::</span><span class="n">mode</span><span class="p">::</span><span class="n">read_write</span><span class="o">&gt;</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>
      <span class="n">h</span><span class="o">.</span><span class="n">parallel_for</span><span class="p">(</span><span class="n">nd_range</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">range</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="nb">range</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">)),</span>
		     <span class="p">[</span><span class="o">=</span><span class="p">](</span><span class="n">nd_item</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">item</span><span class="p">){</span>
		       <span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
		       <span class="nb">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_global_id</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
		       <span class="n">bufacc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">;</span>
		     <span class="p">});</span>
    <span class="p">});</span>

  <span class="n">auto</span> <span class="n">bufacc1</span> <span class="o">=</span> <span class="n">buf</span><span class="o">.</span><span class="n">get_access</span><span class="o">&lt;</span><span class="n">access</span><span class="p">::</span><span class="n">mode</span><span class="p">::</span><span class="n">read</span><span class="o">&gt;</span><span class="p">();</span>
  <span class="k">for</span><span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="nb">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
      <span class="n">std</span><span class="p">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="p">::</span><span class="n">setw</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">bufacc1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;  &quot;</span><span class="p">;</span>
    <span class="n">std</span><span class="p">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>With the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>         <span class="mi">0</span>           <span class="mi">1</span>           <span class="mi">2</span>           <span class="mi">3</span>           <span class="mi">4</span>           <span class="mi">5</span>  
         <span class="mi">1</span>           <span class="mi">2</span>           <span class="mi">3</span>           <span class="mi">4</span>           <span class="mi">5</span>           <span class="mi">6</span>  
         <span class="mi">2</span>           <span class="mi">3</span>           <span class="mi">4</span>           <span class="mi">5</span>           <span class="mi">6</span>           <span class="mi">7</span>  
         <span class="mi">3</span>           <span class="mi">4</span>           <span class="mi">5</span>           <span class="mi">6</span>           <span class="mi">7</span>           <span class="mi">8</span>  
         <span class="mi">4</span>           <span class="mi">5</span>           <span class="mi">6</span>           <span class="mi">7</span>           <span class="mi">8</span>           <span class="mi">9</span>  
         <span class="mi">5</span>           <span class="mi">6</span>           <span class="mi">7</span>           <span class="mi">8</span>           <span class="mi">9</span>          <span class="mi">10</span>  
</pre></div>
</div>
<p class="rubric">ND-Range Parallelism Example</p>
<p>The following discusses the relationships in the use of the ND-range
in the previous code sample.</p>
<ul class="simple">
<li><p>Line 16 is the <code class="docutils literal notranslate"><span class="pre">nd-range</span></code> declaration. <code class="docutils literal notranslate"><span class="pre">nd_range&lt;2&gt;</span></code>
specifies a two-dimensional index space.</p></li>
<li><p>The first argument, <code class="docutils literal notranslate"><span class="pre">range&lt;2&gt;(N,N)</span></code>, defines a <code class="docutils literal notranslate"><span class="pre">N</span></code> by <code class="docutils literal notranslate"><span class="pre">N</span></code>
global index space shape.</p></li>
<li><p>The second argument, <code class="docutils literal notranslate"><span class="pre">range&lt;2&gt;(M,M)</span></code> defines a <code class="docutils literal notranslate"><span class="pre">M</span></code> by <code class="docutils literal notranslate"><span class="pre">M</span></code>
local work-group shape.</p></li>
<li><p>Lines 18 &amp; 19 extract the coordinates of the work item in the index
space</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">sub-group</span></code> is an extension to the SYCL execution model and
sits hierarchically between the <code class="docutils literal notranslate"><span class="pre">work_group</span></code> and <code class="docutils literal notranslate"><span class="pre">work_item</span></code>. The
<code class="docutils literal notranslate"><span class="pre">sub_group</span></code> was created to align with typical hardware resources
that contain a vector unit to execute several similar operations in
parallel and in lock step.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="../parallelism.html#expressing-parallelism"><span class="std std-ref">Expressing parallelism</span></a></p></li>
</ul>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="platform-model.html" title="previous page">Platform Model</a>
    <a class='right-next' id="next-link" href="memory-model.html" title="next page">Memory Model</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Intel<br/>
        
            &copy; Copyright 2020, Intel.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>